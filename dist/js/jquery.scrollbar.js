!function(l,e){"function"==typeof define&&define.amd?define(["jquery"],e):e(l.jQuery)}(this,function(l){"use strict";function e(e){if(t.webkit&&!e)return{height:0,width:0};if(!t.data.outer){var o={border:"none","box-sizing":"content-box",height:"200px",margin:"0",padding:"0",width:"200px"};t.data.inner=l("<div>").css(l.extend({},o)),t.data.outer=l("<div>").css(l.extend({left:"-1000px",overflow:"scroll",position:"absolute",top:"-1000px"},o)).append(t.data.inner).appendTo("body")}return t.data.outer.scrollLeft(1e3).scrollTop(1e3),{height:Math.ceil(t.data.outer.offset().top-t.data.inner.offset().top||0),width:Math.ceil(t.data.outer.offset().left-t.data.inner.offset().left||0)}}function o(){var l=e(!0);return!(l.height||l.width)}function s(l){var e=l.originalEvent;return(!e.axis||e.axis!==e.HORIZONTAL_AXIS)&&!e.wheelDeltaX}var r=!1,t={data:{index:0,name:"scrollbar"},macosx:/mac/i.test(navigator.platform),mobile:/android|webos|iphone|ipad|ipod|blackberry/i.test(navigator.userAgent),overlay:null,scroll:null,scrolls:[],webkit:/webkit/i.test(navigator.userAgent)&&!/edge\/\d+/i.test(navigator.userAgent)};t.scrolls.add=function(l){this.remove(l).push(l)},t.scrolls.remove=function(e){for(;l.inArray(e,this)>=0;)this.splice(l.inArray(e,this),1);return this};var i={autoScrollSize:!0,autoUpdate:!0,debug:!1,disableBodyScroll:!1,duration:200,ignoreMobile:!1,ignoreOverlay:!1,scrollStep:30,showArrows:!1,stepScrolling:!0,scrollx:null,scrolly:null,onDestroy:null,onInit:null,onScroll:null,onUpdate:null},n=function(s){t.scroll||(t.overlay=o(),t.scroll=e(),a(),l(window).resize(function(){var l=!1;if(t.scroll&&(t.scroll.height||t.scroll.width)){var o=e();o.height===t.scroll.height&&o.width===t.scroll.width||(t.scroll=o,l=!0)}a(l)})),this.container=s,this.namespace=".scrollbar_"+t.data.index++,this.options=l.extend({},i,window.jQueryScrollbarOptions||{}),this.scrollTo=null,this.scrollx={},this.scrolly={},s.data(t.data.name,this),t.scrolls.add(this)};n.prototype={destroy:function(){if(this.wrapper){this.container.removeData(t.data.name),t.scrolls.remove(this);var e=this.container.scrollLeft(),o=this.container.scrollTop();this.container.insertBefore(this.wrapper).css({height:"",margin:"","max-height":""}).removeClass("scroll-content scroll-scrollx_visible scroll-scrolly_visible").off(this.namespace).scrollLeft(e).scrollTop(o),this.scrollx.scroll.removeClass("scroll-scrollx_visible").find("div").andSelf().off(this.namespace),this.scrolly.scroll.removeClass("scroll-scrolly_visible").find("div").andSelf().off(this.namespace),this.wrapper.remove(),l(document).add("body").off(this.namespace),l.isFunction(this.options.onDestroy)&&this.options.onDestroy.apply(this,[this.container])}},init:function(e){var o=this,r=this.container,i=this.containerWrapper||r,n=this.namespace,c=l.extend(this.options,e||{}),a={x:this.scrollx,y:this.scrolly},d=this.wrapper,h={scrollLeft:r.scrollLeft(),scrollTop:r.scrollTop()};if(t.mobile&&c.ignoreMobile||t.overlay&&c.ignoreOverlay||t.macosx&&!t.webkit)return!1;if(d)i.css({height:"auto","margin-bottom":t.scroll.height*-1+"px","margin-right":t.scroll.width*-1+"px","max-height":""});else{if(this.wrapper=d=l("<div>").addClass("scroll-wrapper").addClass(r.attr("class")).css("position","absolute"==r.css("position")?"absolute":"relative").insertBefore(r).append(r),r.is("textarea")&&(this.containerWrapper=i=l("<div>").insertBefore(r).append(r),d.addClass("scroll-textarea")),i.addClass("scroll-content").css({height:"auto","margin-bottom":t.scroll.height*-1+"px","margin-right":t.scroll.width*-1+"px","max-height":""}),r.on("scroll"+n,function(e){l.isFunction(c.onScroll)&&c.onScroll.call(o,{maxScroll:a.y.maxScrollOffset,scroll:r.scrollTop(),size:a.y.size,visible:a.y.visible},{maxScroll:a.x.maxScrollOffset,scroll:r.scrollLeft(),size:a.x.size,visible:a.x.visible}),a.x.isVisible&&a.x.scroll.bar.css("left",r.scrollLeft()*a.x.kx+"px"),a.y.isVisible&&a.y.scroll.bar.css("top",r.scrollTop()*a.y.kx+"px")}),d.on("scroll"+n,function(){d.scrollTop(0).scrollLeft(0)}),c.disableBodyScroll){var p=function(l){s(l)?a.y.isVisible&&a.y.mousewheel(l):a.x.isVisible&&a.x.mousewheel(l)};d.on("MozMousePixelScroll"+n,p),d.on("mousewheel"+n,p),t.mobile&&d.on("touchstart"+n,function(e){var o=e.originalEvent.touches&&e.originalEvent.touches[0]||e,s={pageX:o.pageX,pageY:o.pageY},t={left:r.scrollLeft(),top:r.scrollTop()};l(document).on("touchmove"+n,function(l){var e=l.originalEvent.targetTouches&&l.originalEvent.targetTouches[0]||l;r.scrollLeft(t.left+s.pageX-e.pageX),r.scrollTop(t.top+s.pageY-e.pageY),l.preventDefault()}),l(document).on("touchend"+n,function(){l(document).off(n)})})}l.isFunction(c.onInit)&&c.onInit.apply(this,[r])}l.each(a,function(e,t){var i=null,d=1,h="x"===e?"scrollLeft":"scrollTop",p=c.scrollStep,u=function(){var l=r[h]();r[h](l+p),1==d&&l+p>=f&&(l=r[h]()),d==-1&&l+p<=f&&(l=r[h]()),r[h]()==l&&i&&i()},f=0;t.scroll||(t.scroll=o._getScroll(c["scroll"+e]).addClass("scroll-"+e),c.showArrows&&t.scroll.addClass("scroll-element_arrows_visible"),t.mousewheel=function(l){if(!t.isVisible||"x"===e&&s(l))return!0;if("y"===e&&!s(l))return a.x.mousewheel(l),!0;var i=l.originalEvent.wheelDelta*-1||l.originalEvent.detail,n=t.size-t.visible-t.offset;return(i>0&&f<n||i<0&&f>0)&&(f+=i,f<0&&(f=0),f>n&&(f=n),o.scrollTo=o.scrollTo||{},o.scrollTo[h]=f,setTimeout(function(){o.scrollTo&&(r.stop().animate(o.scrollTo,240,"linear",function(){f=r[h]()}),o.scrollTo=null)},1)),l.preventDefault(),!1},t.scroll.on("MozMousePixelScroll"+n,t.mousewheel).on("mousewheel"+n,t.mousewheel).on("mouseenter"+n,function(){f=r[h]()}),t.scroll.find(".scroll-arrow, .scroll-element_track").on("mousedown"+n,function(s){if(1!=s.which)return!0;d=1;var n={eventOffset:s["x"===e?"pageX":"pageY"],maxScrollValue:t.size-t.visible-t.offset,scrollbarOffset:t.scroll.bar.offset()["x"===e?"left":"top"],scrollbarSize:t.scroll.bar["x"===e?"outerWidth":"outerHeight"]()},a=0,v=0;return l(this).hasClass("scroll-arrow")?(d=l(this).hasClass("scroll-arrow_more")?1:-1,p=c.scrollStep*d,f=d>0?n.maxScrollValue:0):(d=n.eventOffset>n.scrollbarOffset+n.scrollbarSize?1:n.eventOffset<n.scrollbarOffset?-1:0,p=Math.round(.75*t.visible)*d,f=n.eventOffset-n.scrollbarOffset-(c.stepScrolling?1==d?n.scrollbarSize:0:Math.round(n.scrollbarSize/2)),f=r[h]()+f/t.kx),o.scrollTo=o.scrollTo||{},o.scrollTo[h]=c.stepScrolling?r[h]()+p:f,c.stepScrolling&&(i=function(){f=r[h](),clearInterval(v),clearTimeout(a),a=0,v=0},a=setTimeout(function(){v=setInterval(u,40)},c.duration+100)),setTimeout(function(){o.scrollTo&&(r.animate(o.scrollTo,c.duration),o.scrollTo=null)},1),o._handleMouseDown(i,s)}),t.scroll.bar.on("mousedown"+n,function(s){if(1!=s.which)return!0;var i=s["x"===e?"pageX":"pageY"],c=r[h]();return t.scroll.addClass("scroll-draggable"),l(document).on("mousemove"+n,function(l){var o=parseInt((l["x"===e?"pageX":"pageY"]-i)/t.kx,10);r[h](c+o)}),o._handleMouseDown(function(){t.scroll.removeClass("scroll-draggable"),f=r[h]()},s)}))}),l.each(a,function(l,e){var o="scroll-scroll"+l+"_visible",s="x"==l?a.y:a.x;e.scroll.removeClass(o),s.scroll.removeClass(o),i.removeClass(o)}),l.each(a,function(e,o){l.extend(o,"x"==e?{offset:parseInt(r.css("left"),10)||0,size:r.prop("scrollWidth"),visible:d.width()}:{offset:parseInt(r.css("top"),10)||0,size:r.prop("scrollHeight"),visible:d.height()})}),this._updateScroll("x",this.scrollx),this._updateScroll("y",this.scrolly),l.isFunction(c.onUpdate)&&c.onUpdate.apply(this,[r]),l.each(a,function(l,e){var o="x"===l?"left":"top",s="x"===l?"outerWidth":"outerHeight",t="x"===l?"width":"height",i=parseInt(r.css(o),10)||0,n=e.size,a=e.visible+i,d=e.scroll.size[s]()+(parseInt(e.scroll.size.css(o),10)||0);c.autoScrollSize&&(e.scrollbarSize=parseInt(d*a/n,10),e.scroll.bar.css(t,e.scrollbarSize+"px")),e.scrollbarSize=e.scroll.bar[s](),e.kx=(d-e.scrollbarSize)/(n-a)||1,e.maxScrollOffset=n-a}),r.scrollLeft(h.scrollLeft).scrollTop(h.scrollTop).trigger("scroll")},_getScroll:function(e){var o={advanced:['<div class="scroll-element">','<div class="scroll-element_corner"></div>','<div class="scroll-arrow scroll-arrow_less"></div>','<div class="scroll-arrow scroll-arrow_more"></div>','<div class="scroll-element_outer">','<div class="scroll-element_size"></div>','<div class="scroll-element_inner-wrapper">','<div class="scroll-element_inner scroll-element_track">','<div class="scroll-element_inner-bottom"></div>',"</div>","</div>",'<div class="scroll-bar">','<div class="scroll-bar_body">','<div class="scroll-bar_body-inner"></div>',"</div>",'<div class="scroll-bar_bottom"></div>','<div class="scroll-bar_center"></div>',"</div>","</div>","</div>"].join(""),simple:['<div class="scroll-element">','<div class="scroll-element_outer">','<div class="scroll-element_size"></div>','<div class="scroll-element_track"></div>','<div class="scroll-bar"></div>',"</div>","</div>"].join("")};return o[e]&&(e=o[e]),e||(e=o.simple),e="string"==typeof e?l(e).appendTo(this.wrapper):l(e),l.extend(e,{bar:e.find(".scroll-bar"),size:e.find(".scroll-element_size"),track:e.find(".scroll-element_track")}),e},_handleMouseDown:function(e,o){var s=this.namespace;return l(document).on("blur"+s,function(){l(document).add("body").off(s),e&&e()}),l(document).on("dragstart"+s,function(l){return l.preventDefault(),!1}),l(document).on("mouseup"+s,function(){l(document).add("body").off(s),e&&e()}),l("body").on("selectstart"+s,function(l){return l.preventDefault(),!1}),o&&o.preventDefault(),!1},_updateScroll:function(e,o){var s=this.container,r=this.containerWrapper||s,i="scroll-scroll"+e+"_visible",n="x"===e?this.scrolly:this.scrollx,c=parseInt(this.container.css("x"===e?"left":"top"),10)||0,a=this.wrapper,d=o.size,h=o.visible+c;o.isVisible=d-h>1,o.isVisible?(o.scroll.addClass(i),n.scroll.addClass(i),r.addClass(i)):(o.scroll.removeClass(i),n.scroll.removeClass(i),r.removeClass(i)),"y"===e&&(s.is("textarea")||d<h?r.css({height:h+t.scroll.height+"px","max-height":"none"}):r.css({"max-height":h+t.scroll.height+"px"})),o.size==s.prop("scrollWidth")&&n.size==s.prop("scrollHeight")&&o.visible==a.width()&&n.visible==a.height()&&o.offset==(parseInt(s.css("left"),10)||0)&&n.offset==(parseInt(s.css("top"),10)||0)||(l.extend(this.scrollx,{offset:parseInt(s.css("left"),10)||0,size:s.prop("scrollWidth"),visible:a.width()}),l.extend(this.scrolly,{offset:parseInt(s.css("top"),10)||0,size:this.container.prop("scrollHeight"),visible:a.height()}),this._updateScroll("x"===e?"y":"x",n))}};var c=n;l.fn.scrollbar=function(e,o){return"string"!=typeof e&&(o=e,e="init"),"undefined"==typeof o&&(o=[]),l.isArray(o)||(o=[o]),this.not("body, .scroll-wrapper").each(function(){var s=l(this),r=s.data(t.data.name);(r||"init"===e)&&(r||(r=new c(s)),r[e]&&r[e].apply(r,o))}),this},l.fn.scrollbar.options=i;var a=function(){var l=0,e=0;return function(o){var s,i,n,c,d,h,p;for(s=0;s<t.scrolls.length;s++)c=t.scrolls[s],i=c.container,n=c.options,d=c.wrapper,h=c.scrollx,p=c.scrolly,(o||n.autoUpdate&&d&&d.is(":visible")&&(i.prop("scrollWidth")!=h.size||i.prop("scrollHeight")!=p.size||d.width()!=h.visible||d.height()!=p.visible))&&(c.init(),n.debug&&(window.console&&console.log({scrollHeight:i.prop("scrollHeight")+":"+c.scrolly.size,scrollWidth:i.prop("scrollWidth")+":"+c.scrollx.size,visibleHeight:d.height()+":"+c.scrolly.visible,visibleWidth:d.width()+":"+c.scrollx.visible},!0),e++));r&&e>10?(window.console&&console.log("Scroll updates exceed 10"),a=function(){}):(clearTimeout(l),l=setTimeout(a,300))}}();window.angular&&!function(l){l.module("jQueryScrollbar",[]).provider("jQueryScrollbar",function(){var e=i;return{setOptions:function(o){l.extend(e,o)},$get:function(){return{options:l.copy(e)}}}}).directive("jqueryScrollbar",["jQueryScrollbar","$parse",function(l,e){return{restrict:"AC",link:function(o,s,r){var t=e(r.jqueryScrollbar),i=t(o);s.scrollbar(i||l.options).on("$destroy",function(){s.scrollbar("destroy")})}}}])}(window.angular)});
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImpxdWVyeS5zY3JvbGxiYXIuanMiXSwibmFtZXMiOlsicm9vdCIsImZhY3RvcnkiLCJkZWZpbmUiLCJhbWQiLCJqUXVlcnkiLCJ0aGlzIiwiJCIsImdldEJyb3dzZXJTY3JvbGxTaXplIiwiYWN0dWFsU2l6ZSIsImJyb3dzZXIiLCJ3ZWJraXQiLCJoZWlnaHQiLCJ3aWR0aCIsImRhdGEiLCJvdXRlciIsImNzcyIsImJvcmRlciIsImJveC1zaXppbmciLCJtYXJnaW4iLCJwYWRkaW5nIiwiaW5uZXIiLCJleHRlbmQiLCJsZWZ0Iiwib3ZlcmZsb3ciLCJwb3NpdGlvbiIsInRvcCIsImFwcGVuZCIsImFwcGVuZFRvIiwic2Nyb2xsTGVmdCIsInNjcm9sbFRvcCIsIk1hdGgiLCJjZWlsIiwib2Zmc2V0IiwiaXNTY3JvbGxPdmVybGF5c0NvbnRlbnQiLCJzY3JvbGxTaXplIiwiaXNWZXJ0aWNhbFNjcm9sbCIsImV2ZW50IiwiZSIsIm9yaWdpbmFsRXZlbnQiLCJheGlzIiwiSE9SSVpPTlRBTF9BWElTIiwid2hlZWxEZWx0YVgiLCJkZWJ1ZyIsImluZGV4IiwibmFtZSIsIm1hY29zeCIsInRlc3QiLCJuYXZpZ2F0b3IiLCJwbGF0Zm9ybSIsIm1vYmlsZSIsInVzZXJBZ2VudCIsIm92ZXJsYXkiLCJzY3JvbGwiLCJzY3JvbGxzIiwiYWRkIiwiaW5zdGFuY2UiLCJyZW1vdmUiLCJwdXNoIiwiaW5BcnJheSIsInNwbGljZSIsImRlZmF1bHRzIiwiYXV0b1Njcm9sbFNpemUiLCJhdXRvVXBkYXRlIiwiZGlzYWJsZUJvZHlTY3JvbGwiLCJkdXJhdGlvbiIsImlnbm9yZU1vYmlsZSIsImlnbm9yZU92ZXJsYXkiLCJzY3JvbGxTdGVwIiwic2hvd0Fycm93cyIsInN0ZXBTY3JvbGxpbmciLCJzY3JvbGx4Iiwic2Nyb2xseSIsIm9uRGVzdHJveSIsIm9uSW5pdCIsIm9uU2Nyb2xsIiwib25VcGRhdGUiLCJCYXNlU2Nyb2xsYmFyIiwiY29udGFpbmVyIiwidXBkYXRlU2Nyb2xsYmFycyIsIndpbmRvdyIsInJlc2l6ZSIsImZvcmNlVXBkYXRlIiwibmFtZXNwYWNlIiwib3B0aW9ucyIsImpRdWVyeVNjcm9sbGJhck9wdGlvbnMiLCJzY3JvbGxUbyIsInByb3RvdHlwZSIsImRlc3Ryb3kiLCJ3cmFwcGVyIiwicmVtb3ZlRGF0YSIsImluc2VydEJlZm9yZSIsIm1heC1oZWlnaHQiLCJyZW1vdmVDbGFzcyIsIm9mZiIsImZpbmQiLCJhbmRTZWxmIiwiZG9jdW1lbnQiLCJpc0Z1bmN0aW9uIiwiYXBwbHkiLCJpbml0IiwiUyIsImMiLCJjdyIsImNvbnRhaW5lcldyYXBwZXIiLCJvIiwicyIsIngiLCJ5IiwidyIsImluaXRTY3JvbGwiLCJtYXJnaW4tYm90dG9tIiwibWFyZ2luLXJpZ2h0IiwiYWRkQ2xhc3MiLCJhdHRyIiwiaXMiLCJvbiIsImNhbGwiLCJtYXhTY3JvbGwiLCJtYXhTY3JvbGxPZmZzZXQiLCJzaXplIiwidmlzaWJsZSIsImlzVmlzaWJsZSIsImJhciIsImt4IiwiaGFuZGxlTW91c2VTY3JvbGwiLCJtb3VzZXdoZWVsIiwidG91Y2giLCJ0b3VjaGVzIiwib3JpZ2luYWxUb3VjaCIsInBhZ2VYIiwicGFnZVkiLCJvcmlnaW5hbFNjcm9sbCIsInRhcmdldFRvdWNoZXMiLCJwcmV2ZW50RGVmYXVsdCIsImVhY2giLCJkIiwic2Nyb2xsQ2FsbGJhY2siLCJzY3JvbGxGb3J3YXJkIiwic2Nyb2xsT2Zmc2V0IiwiY3VycmVudE9mZnNldCIsInNjcm9sbFRvVmFsdWUiLCJfZ2V0U2Nyb2xsIiwiZGVsdGEiLCJ3aGVlbERlbHRhIiwiZGV0YWlsIiwibWF4U2Nyb2xsVmFsdWUiLCJzZXRUaW1lb3V0Iiwic3RvcCIsImFuaW1hdGUiLCJ3aGljaCIsImV2ZW50T2Zmc2V0Iiwic2Nyb2xsYmFyT2Zmc2V0Iiwic2Nyb2xsYmFyU2l6ZSIsInRpbWVvdXQiLCJ0aW1lciIsImhhc0NsYXNzIiwicm91bmQiLCJjbGVhckludGVydmFsIiwiY2xlYXJUaW1lb3V0Iiwic2V0SW50ZXJ2YWwiLCJfaGFuZGxlTW91c2VEb3duIiwiZXZlbnRQb3NpdGlvbiIsImluaXRPZmZzZXQiLCJkaWZmIiwicGFyc2VJbnQiLCJzY3JvbGxDbGFzcyIsInByb3AiLCJfdXBkYXRlU2Nyb2xsIiwiY3NzT2Zmc2V0IiwiY3NzRnVsbFNpemUiLCJjc3NTaXplIiwiQXJlYVNpemUiLCJBcmVhVmlzaWJsZSIsInRyaWdnZXIiLCJ0eXBlcyIsImFkdmFuY2VkIiwiam9pbiIsInNpbXBsZSIsInRyYWNrIiwiY2FsbGJhY2siLCJDdXN0b21TY3JvbGxiYXIiLCJmbiIsInNjcm9sbGJhciIsImNvbW1hbmQiLCJhcmdzIiwiaXNBcnJheSIsIm5vdCIsImVsZW1lbnQiLCJ0aW1lckNvdW50ZXIiLCJmb3JjZSIsImkiLCJsZW5ndGgiLCJjb25zb2xlIiwibG9nIiwic2Nyb2xsSGVpZ2h0Iiwic2Nyb2xsV2lkdGgiLCJ2aXNpYmxlSGVpZ2h0IiwidmlzaWJsZVdpZHRoIiwiYW5ndWxhciIsIm1vZHVsZSIsInByb3ZpZGVyIiwiZGVmYXVsdE9wdGlvbnMiLCJzZXRPcHRpb25zIiwiJGdldCIsImNvcHkiLCJkaXJlY3RpdmUiLCJqUXVlcnlTY3JvbGxiYXIiLCIkcGFyc2UiLCJyZXN0cmljdCIsImxpbmsiLCJzY29wZSIsImF0dHJzIiwibW9kZWwiLCJqcXVlcnlTY3JvbGxiYXIiXSwibWFwcGluZ3MiOiJDQWNDLFNBQVVBLEVBQU1DLEdBQ1Msa0JBQVhDLFNBQXlCQSxPQUFPQyxJQUN2Q0QsUUFBUSxVQUFXRCxHQUVuQkEsRUFBUUQsRUFBS0ksU0FFbkJDLEtBQU0sU0FBVUMsR0FDZCxZQTRwQkEsU0FBU0MsR0FBcUJDLEdBRTFCLEdBQUlDLEVBQVFDLFNBQVdGLEVBQ25CLE9BQ0lHLE9BQVUsRUFDVkMsTUFBUyxFQUlqQixLQUFLSCxFQUFRSSxLQUFLQyxNQUFPLENBQ3JCLEdBQUlDLElBQ0FDLE9BQVUsT0FDVkMsYUFBYyxjQUNkTixPQUFVLFFBQ1ZPLE9BQVUsSUFDVkMsUUFBVyxJQUNYUCxNQUFTLFFBRWJILEdBQVFJLEtBQUtP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Q3RELEdBQ0hvRSxLQUlSbEosSUFBU2tKLEVBQWUsSUFDeEI3RyxPQUFPaUgsU0FBV0EsUUFBUUMsSUFBSSw0QkFDOUJuSCxFQUFtQixlQUVuQmdGLGFBQWFKLEdBQ2JBLEVBQVFSLFdBQVdwRSxFQUFrQixTQXdFN0NDLFFBQU91SCxVQUNQLFNBQVdBLEdBQ1BBLEVBQVFDLE9BQU8sc0JBQ1ZDLFNBQVMsa0JBQW1CLFdBQ3pCLEdBQUlDLEdBQWlCN0ksQ0FDckIsUUFDSThJLFdBQVksU0FBVXZILEdBQ2xCbUgsRUFBUWpMLE9BQU9vTCxFQUFnQnRILElBRW5Dd0gsS0FBTSxXQUNGLE9BQ0l4SCxRQUFTbUgsRUFBUU0sS0FBS0gsUUFLckNJLFVBQVUsbUJBQW9CLGtCQUFtQixTQUFVLFNBQVVDLEVBQWlCQyxHQUNuRixPQUNJQyxTQUFZLEtBQ1pDLEtBQVEsU0FBVUMsRUFBT3ZCLEVBQVN3QixHQUM5QixHQUFJQyxHQUFRTCxFQUFPSSxFQUFNRSxpQkFDckJsSSxFQUFVaUksRUFBTUYsRUFDcEJ2QixHQUFRTCxVQUFVbkcsR0FBVzJILEVBQWdCM0gsU0FDeENnQyxHQUFHLFdBQVksV0FDWndFLEVBQVFMLFVBQVUsbUJBSzNDdkcsT0FBT3VIIiwiZmlsZSI6ImpxdWVyeS5zY3JvbGxiYXIuanMiLCJzb3VyY2VzQ29udGVudCI6WyIvKipcbiAqIGpRdWVyeSBDU1MgQ3VzdG9taXphYmxlIFNjcm9sbGJhclxuICpcbiAqIENvcHlyaWdodCAyMDE1LCBZdXJpeSBLaGFiYXJvdlxuICogRHVhbCBsaWNlbnNlZCB1bmRlciB0aGUgTUlUIG9yIEdQTCBWZXJzaW9uIDIgbGljZW5zZXMuXG4gKlxuICogSWYgeW91IGZvdW5kIGJ1ZywgcGxlYXNlIGNvbnRhY3QgbWUgdmlhIGVtYWlsIDwxM3JlYWwwMDhAZ21haWwuY29tPlxuICpcbiAqIEBhdXRob3IgWXVyaXkgS2hhYmFyb3YgYWthIEdyb21vXG4gKiBAdmVyc2lvbiAwLjIuMTBcbiAqIEB1cmwgaHR0cHM6Ly9naXRodWIuY29tL2dyb21vL2pxdWVyeS5zY3JvbGxiYXIvXG4gKlxuICovXG47XG4oZnVuY3Rpb24gKHJvb3QsIGZhY3RvcnkpIHtcbiAgICBpZiAodHlwZW9mIGRlZmluZSA9PT0gJ2Z1bmN0aW9uJyAmJiBkZWZpbmUuYW1kKSB7XG4gICAgICAgIGRlZmluZShbJ2pxdWVyeSddLCBmYWN0b3J5KTtcbiAgICB9IGVsc2Uge1xuICAgICAgICBmYWN0b3J5KHJvb3QualF1ZXJ5KTtcbiAgICB9XG59KHRoaXMsIGZ1bmN0aW9uICgkKSB7XG4gICAgJ3VzZSBzdHJpY3QnO1xuXG4gICAgLy8gaW5pdCBmbGFncyAmIHZhcmlhYmxlc1xuICAgIHZhciBkZWJ1ZyA9IGZhbHNlO1xuXG4gICAgdmFyIGJyb3dzZXIgPSB7XG4gICAgICAgIGRhdGE6IHtcbiAgICAgICAgICAgIGluZGV4OiAwLFxuICAgICAgICAgICAgbmFtZTogJ3Njcm9sbGJhcidcbiAgICAgICAgfSxcbiAgICAgICAgbWFjb3N4OiAvbWFjL2kudGVzdChuYXZpZ2F0b3IucGxhdGZvcm0pLFxuICAgICAgICBtb2JpbGU6IC9hbmRyb2lkfHdlYm9zfGlwaG9uZXxpcGFkfGlwb2R8YmxhY2tiZXJyeS9pLnRlc3QobmF2aWdhdG9yLnVzZXJBZ2VudCksXG4gICAgICAgIG92ZXJsYXk6IG51bGwsXG4gICAgICAgIHNjcm9sbDogbnVsbCxcbiAgICAgICAgc2Nyb2xsczogW10sXG4gICAgICAgIHdlYmtpdDogL3dlYmtpdC9pLnRlc3QobmF2aWdhdG9yLnVzZXJBZ2VudCkgJiYgIS9lZGdlXFwvXFxkKy9pLnRlc3QobmF2aWdhdG9yLnVzZXJBZ2VudClcbiAgICB9O1xuXG4gICAgYnJvd3Nlci5zY3JvbGxzLmFkZCA9IGZ1bmN0aW9uIChpbnN0YW5jZSkge1xuICAgICAgICB0aGlzLnJlbW92ZShpbnN0YW5jZSkucHVzaChpbnN0YW5jZSk7XG4gICAgfTtcbiAgICBicm93c2VyLnNjcm9sbHMucmVtb3ZlID0gZnVuY3Rpb24gKGluc3RhbmNlKSB7XG4gICAgICAgIHdoaWxlICgkLmluQXJyYXkoaW5zdGFuY2UsIHRoaXMpID49IDApIHtcbiAgICAgICAgICAgIHRoaXMuc3BsaWNlKCQuaW5BcnJheShpbnN0YW5jZSwgdGhpcyksIDEpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgIH07XG5cbiAgICB2YXIgZGVmYXVsdHMgPSB7XG4gICAgICAgIFwiYXV0b1Njcm9sbFNpemVcIjogdHJ1ZSwgICAgIC8vIGF1dG9tYXRpY2FsbHkgY2FsY3VsYXRlIHNjcm9sbHNpemVcbiAgICAgICAgXCJhdXRvVXBkYXRlXCI6IHRydWUsICAgICAgICAgLy8gdXBkYXRlIHNjcm9sbGJhciBpZiBjb250ZW50L2NvbnRhaW5lciBzaXplIGNoYW5nZWRcbiAgICAgICAgXCJkZWJ1Z1wiOiBmYWxzZSwgICAgICAgICAgICAgLy8gZGVidWcgbW9kZVxuICAgICAgICBcImRpc2FibGVCb2R5U2Nyb2xsXCI6IGZhbHNlLCAvLyBkaXNhYmxlIGJvZHkgc2Nyb2xsIGlmIG1vdXNlIG92ZXIgY29udGFpbmVyXG4gICAgICAgIFwiZHVyYXRpb25cIjogMjAwLCAgICAgICAgICAgIC8vIHNjcm9sbCBhbmltYXRlIGR1cmF0aW9uIGluIG1zXG4gICAgICAgIFwiaWdub3JlTW9iaWxlXCI6IGZhbHNlLCAgICAgIC8vIGlnbm9yZSBtb2JpbGUgZGV2aWNlc1xuICAgICAgICBcImlnbm9yZU92ZXJsYXlcIjogZmFsc2UsICAgICAvLyBpZ25vcmUgYnJvd3NlcnMgd2l0aCBvdmVybGF5IHNjcm9sbGJhcnMgKG1vYmlsZSwgTWFjT1MpXG4gICAgICAgIFwic2Nyb2xsU3RlcFwiOiAzMCwgICAgICAgICAgIC8vIHNjcm9sbCBzdGVwIGZvciBzY3JvbGxiYXIgYXJyb3dzXG4gICAgICAgIFwic2hvd0Fycm93c1wiOiBmYWxzZSwgICAgICAgIC8vIGFkZCBjbGFzcyB0byBzaG93IGFycm93c1xuICAgICAgICBcInN0ZXBTY3JvbGxpbmdcIjogdHJ1ZSwgICAgICAvLyB3aGVuIHNjcm9sbGluZyB0byBzY3JvbGxiYXIgbW91c2Vkb3duIHBvc2l0aW9uXG5cbiAgICAgICAgXCJzY3JvbGx4XCI6IG51bGwsICAgICAgICAgICAgLy8gaG9yaXpvbnRhbCBzY3JvbGwgZWxlbWVudFxuICAgICAgICBcInNjcm9sbHlcIjogbnVsbCwgICAgICAgICAgICAvLyB2ZXJ0aWNhbCBzY3JvbGwgZWxlbWVudFxuXG4gICAgICAgIFwib25EZXN0cm95XCI6IG51bGwsICAgICAgICAgIC8vIGNhbGxiYWNrIGZ1bmN0aW9uIG9uIGRlc3Ryb3ksXG4gICAgICAgIFwib25Jbml0XCI6IG51bGwsICAgICAgICAgICAgIC8vIGNhbGxiYWNrIGZ1bmN0aW9uIG9uIGZpcnN0IGluaXRpYWxpemF0aW9uXG4gICAgICAgIFwib25TY3JvbGxcIjogbnVsbCwgICAgICAgICAgIC8vIGNhbGxiYWNrIGZ1bmN0aW9uIG9uIGNvbnRlbnQgc2Nyb2xsaW5nXG4gICAgICAgIFwib25VcGRhdGVcIjogbnVsbCAgICAgICAgICAgIC8vIGNhbGxiYWNrIGZ1bmN0aW9uIG9uIGluaXQvcmVzaXplIChiZWZvcmUgc2Nyb2xsYmFyIHNpemUgY2FsY3VsYXRpb24pXG4gICAgfTtcblxuXG4gICAgdmFyIEJhc2VTY3JvbGxiYXIgPSBmdW5jdGlvbiAoY29udGFpbmVyKSB7XG5cbiAgICAgICAgaWYgKCFicm93c2VyLnNjcm9sbCkge1xuICAgICAgICAgICAgYnJvd3Nlci5vdmVybGF5ID0gaXNTY3JvbGxPdmVybGF5c0NvbnRlbnQoKTtcbiAgICAgICAgICAgIGJyb3dzZXIuc2Nyb2xsID0gZ2V0QnJvd3NlclNjcm9sbFNpemUoKTtcbiAgICAgICAgICAgIHVwZGF0ZVNjcm9sbGJhcnMoKTtcblxuICAgICAgICAgICAgJCh3aW5kb3cpLnJlc2l6ZShmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgdmFyIGZvcmNlVXBkYXRlID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgaWYgKGJyb3dzZXIuc2Nyb2xsICYmIChicm93c2VyLnNjcm9sbC5oZWlnaHQgfHwgYnJvd3Nlci5zY3JvbGwud2lkdGgpKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBzY3JvbGwgPSBnZXRCcm93c2VyU2Nyb2xsU2l6ZSgpO1xuICAgICAgICAgICAgICAgICAgICBpZiAoc2Nyb2xsLmhlaWdodCAhPT0gYnJvd3Nlci5zY3JvbGwuaGVpZ2h0IHx8IHNjcm9sbC53aWR0aCAhPT0gYnJvd3Nlci5zY3JvbGwud2lkdGgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyb3dzZXIuc2Nyb2xsID0gc2Nyb2xsO1xuICAgICAgICAgICAgICAgICAgICAgICAgZm9yY2VVcGRhdGUgPSB0cnVlOyAvLyBoYW5kbGUgcGFnZSB6b29tXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdXBkYXRlU2Nyb2xsYmFycyhmb3JjZVVwZGF0ZSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuXG4gICAgICAgIHRoaXMuY29udGFpbmVyID0gY29udGFpbmVyO1xuICAgICAgICB0aGlzLm5hbWVzcGFjZSA9ICcuc2Nyb2xsYmFyXycgKyBicm93c2VyLmRhdGEuaW5kZXgrKztcbiAgICAgICAgdGhpcy5vcHRpb25zID0gJC5leHRlbmQoe30sIGRlZmF1bHRzLCB3aW5kb3cualF1ZXJ5U2Nyb2xsYmFyT3B0aW9ucyB8fCB7fSk7XG4gICAgICAgIHRoaXMuc2Nyb2xsVG8gPSBudWxsO1xuICAgICAgICB0aGlzLnNjcm9sbHggPSB7fTtcbiAgICAgICAgdGhpcy5zY3JvbGx5ID0ge307XG5cbiAgICAgICAgY29udGFpbmVyLmRhdGEoYnJvd3Nlci5kYXRhLm5hbWUsIHRoaXMpO1xuICAgICAgICBicm93c2VyLnNjcm9sbHMuYWRkKHRoaXMpO1xuICAgIH07XG5cbiAgICBCYXNlU2Nyb2xsYmFyLnByb3RvdHlwZSA9IHtcblxuICAgICAgICBkZXN0cm95OiBmdW5jdGlvbiAoKSB7XG5cbiAgICAgICAgICAgIGlmICghdGhpcy53cmFwcGVyKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB0aGlzLmNvbnRhaW5lci5yZW1vdmVEYXRhKGJyb3dzZXIuZGF0YS5uYW1lKTtcbiAgICAgICAgICAgIGJyb3dzZXIuc2Nyb2xscy5yZW1vdmUodGhpcyk7XG5cbiAgICAgICAgICAgIC8vIGluaXQgdmFyaWFibGVzXG4gICAgICAgICAgICB2YXIgc2Nyb2xsTGVmdCA9IHRoaXMuY29udGFpbmVyLnNjcm9sbExlZnQoKTtcbiAgICAgICAgICAgIHZhciBzY3JvbGxUb3AgPSB0aGlzLmNvbnRhaW5lci5zY3JvbGxUb3AoKTtcblxuICAgICAgICAgICAgdGhpcy5jb250YWluZXIuaW5zZXJ0QmVmb3JlKHRoaXMud3JhcHBlcikuY3NzKHtcbiAgICAgICAgICAgICAgICBcImhlaWdodFwiOiBcIlwiLFxuICAgICAgICAgICAgICAgIFwibWFyZ2luXCI6IFwiXCIsXG4gICAgICAgICAgICAgICAgXCJtYXgtaGVpZ2h0XCI6IFwiXCJcbiAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgLnJlbW92ZUNsYXNzKCdzY3JvbGwtY29udGVudCBzY3JvbGwtc2Nyb2xseF92aXNpYmxlIHNjcm9sbC1zY3JvbGx5X3Zpc2libGUnKVxuICAgICAgICAgICAgICAgIC5vZmYodGhpcy5uYW1lc3BhY2UpXG4gICAgICAgICAgICAgICAgLnNjcm9sbExlZnQoc2Nyb2xsTGVmdClcbiAgICAgICAgICAgICAgICAuc2Nyb2xsVG9wKHNjcm9sbFRvcCk7XG5cbiAgICAgICAgICAgIHRoaXMuc2Nyb2xseC5zY3JvbGwucmVtb3ZlQ2xhc3MoJ3Njcm9sbC1zY3JvbGx4X3Zpc2libGUnKS5maW5kKCdkaXYnKS5hbmRTZWxmKCkub2ZmKHRoaXMubmFtZXNwYWNlKTtcbiAgICAgICAgICAgIHRoaXMuc2Nyb2xseS5zY3JvbGwucmVtb3ZlQ2xhc3MoJ3Njcm9sbC1zY3JvbGx5X3Zpc2libGUnKS5maW5kKCdkaXYnKS5hbmRTZWxmKCkub2ZmKHRoaXMubmFtZXNwYWNlKTtcblxuICAgICAgICAgICAgdGhpcy53cmFwcGVyLnJlbW92ZSgpO1xuXG4gICAgICAgICAgICAkKGRvY3VtZW50KS5hZGQoJ2JvZHknKS5vZmYodGhpcy5uYW1lc3BhY2UpO1xuXG4gICAgICAgICAgICBpZiAoJC5pc0Z1bmN0aW9uKHRoaXMub3B0aW9ucy5vbkRlc3Ryb3kpKXtcbiAgICAgICAgICAgICAgICB0aGlzLm9wdGlvbnMub25EZXN0cm95LmFwcGx5KHRoaXMsIFt0aGlzLmNvbnRhaW5lcl0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICBpbml0OiBmdW5jdGlvbiAob3B0aW9ucykge1xuXG4gICAgICAgICAgICAvLyBpbml0IHZhcmlhYmxlc1xuICAgICAgICAgICAgdmFyIFMgPSB0aGlzLFxuICAgICAgICAgICAgICAgIGMgPSB0aGlzLmNvbnRhaW5lcixcbiAgICAgICAgICAgICAgICBjdyA9IHRoaXMuY29udGFpbmVyV3JhcHBlciB8fCBjLFxuICAgICAgICAgICAgICAgIG5hbWVzcGFjZSA9IHRoaXMubmFtZXNwYWNlLFxuICAgICAgICAgICAgICAgIG8gPSAkLmV4dGVuZCh0aGlzLm9wdGlvbnMsIG9wdGlvbnMgfHwge30pLFxuICAgICAgICAgICAgICAgIHMgPSB7eDogdGhpcy5zY3JvbGx4LCB5OiB0aGlzLnNjcm9sbHl9LFxuICAgICAgICAgICAgICAgIHcgPSB0aGlzLndyYXBwZXI7XG5cbiAgICAgICAgICAgIHZhciBpbml0U2Nyb2xsID0ge1xuICAgICAgICAgICAgICAgIFwic2Nyb2xsTGVmdFwiOiBjLnNjcm9sbExlZnQoKSxcbiAgICAgICAgICAgICAgICBcInNjcm9sbFRvcFwiOiBjLnNjcm9sbFRvcCgpXG4gICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICAvLyBkbyBub3QgaW5pdCBpZiBpbiBpZ25vcmFibGUgYnJvd3NlclxuICAgICAgICAgICAgaWYgKChicm93c2VyLm1vYmlsZSAmJiBvLmlnbm9yZU1vYmlsZSlcbiAgICAgICAgICAgICAgICB8fCAoYnJvd3Nlci5vdmVybGF5ICYmIG8uaWdub3JlT3ZlcmxheSlcbiAgICAgICAgICAgICAgICB8fCAoYnJvd3Nlci5tYWNvc3ggJiYgIWJyb3dzZXIud2Via2l0KSAvLyBzdGlsbCByZXF1aXJlZCB0byBpZ25vcmUgbm9uV2ViS2l0IGJyb3dzZXJzIG9uIE1hY1xuICAgICAgICAgICAgICAgICkge1xuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy8gaW5pdCBzY3JvbGwgY29udGFpbmVyXG4gICAgICAgICAgICBpZiAoIXcpIHtcbiAgICAgICAgICAgICAgICB0aGlzLndyYXBwZXIgPSB3ID0gJCgnPGRpdj4nKS5hZGRDbGFzcygnc2Nyb2xsLXdyYXBwZXInKS5hZGRDbGFzcyhjLmF0dHIoJ2NsYXNzJykpXG4gICAgICAgICAgICAgICAgICAgIC5jc3MoJ3Bvc2l0aW9uJywgYy5jc3MoJ3Bvc2l0aW9uJykgPT0gJ2Fic29sdXRlJyA/ICdhYnNvbHV0ZScgOiAncmVsYXRpdmUnKVxuICAgICAgICAgICAgICAgICAgICAuaW5zZXJ0QmVmb3JlKGMpLmFwcGVuZChjKTtcblxuICAgICAgICAgICAgICAgIGlmIChjLmlzKCd0ZXh0YXJlYScpKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuY29udGFpbmVyV3JhcHBlciA9IGN3ID0gJCgnPGRpdj4nKS5pbnNlcnRCZWZvcmUoYykuYXBwZW5kKGMpO1xuICAgICAgICAgICAgICAgICAgICB3LmFkZENsYXNzKCdzY3JvbGwtdGV4dGFyZWEnKTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBjdy5hZGRDbGFzcygnc2Nyb2xsLWNvbnRlbnQnKS5jc3Moe1xuICAgICAgICAgICAgICAgICAgICBcImhlaWdodFwiOiBcImF1dG9cIixcbiAgICAgICAgICAgICAgICAgICAgXCJtYXJnaW4tYm90dG9tXCI6IGJyb3dzZXIuc2Nyb2xsLmhlaWdodCAqIC0xICsgJ3B4JyxcbiAgICAgICAgICAgICAgICAgICAgXCJtYXJnaW4tcmlnaHRcIjogYnJvd3Nlci5zY3JvbGwud2lkdGggKiAtMSArICdweCcsXG4gICAgICAgICAgICAgICAgICAgIFwibWF4LWhlaWdodFwiOiBcIlwiXG4gICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICBjLm9uKCdzY3JvbGwnICsgbmFtZXNwYWNlLCBmdW5jdGlvbiAoZXZlbnQpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKCQuaXNGdW5jdGlvbihvLm9uU2Nyb2xsKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgby5vblNjcm9sbC5jYWxsKFMsIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIm1heFNjcm9sbFwiOiBzLnkubWF4U2Nyb2xsT2Zmc2V0LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwic2Nyb2xsXCI6IGMuc2Nyb2xsVG9wKCksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJzaXplXCI6IHMueS5zaXplLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwidmlzaWJsZVwiOiBzLnkudmlzaWJsZVxuICAgICAgICAgICAgICAgICAgICAgICAgfSwge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwibWF4U2Nyb2xsXCI6IHMueC5tYXhTY3JvbGxPZmZzZXQsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJzY3JvbGxcIjogYy5zY3JvbGxMZWZ0KCksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJzaXplXCI6IHMueC5zaXplLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwidmlzaWJsZVwiOiBzLngudmlzaWJsZVxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgcy54LmlzVmlzaWJsZSAmJiBzLnguc2Nyb2xsLmJhci5jc3MoJ2xlZnQnLCBjLnNjcm9sbExlZnQoKSAqIHMueC5reCArICdweCcpO1xuICAgICAgICAgICAgICAgICAgICBzLnkuaXNWaXNpYmxlICYmIHMueS5zY3JvbGwuYmFyLmNzcygndG9wJywgYy5zY3JvbGxUb3AoKSAqIHMueS5reCArICdweCcpO1xuICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgLyogcHJldmVudCBuYXRpdmUgc2Nyb2xsYmFycyB0byBiZSB2aXNpYmxlIG9uICNhbmNob3IgY2xpY2sgKi9cbiAgICAgICAgICAgICAgICB3Lm9uKCdzY3JvbGwnICsgbmFtZXNwYWNlLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgIHcuc2Nyb2xsVG9wKDApLnNjcm9sbExlZnQoMCk7XG4gICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICBpZiAoby5kaXNhYmxlQm9keVNjcm9sbCkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgaGFuZGxlTW91c2VTY3JvbGwgPSBmdW5jdGlvbiAoZXZlbnQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlzVmVydGljYWxTY3JvbGwoZXZlbnQpID9cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzLnkuaXNWaXNpYmxlICYmIHMueS5tb3VzZXdoZWVsKGV2ZW50KSA6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcy54LmlzVmlzaWJsZSAmJiBzLngubW91c2V3aGVlbChldmVudCk7XG4gICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICAgIHcub24oJ01vek1vdXNlUGl4ZWxTY3JvbGwnICsgbmFtZXNwYWNlLCBoYW5kbGVNb3VzZVNjcm9sbCk7XG4gICAgICAgICAgICAgICAgICAgIHcub24oJ21vdXNld2hlZWwnICsgbmFtZXNwYWNlLCBoYW5kbGVNb3VzZVNjcm9sbCk7XG5cbiAgICAgICAgICAgICAgICAgICAgaWYgKGJyb3dzZXIubW9iaWxlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB3Lm9uKCd0b3VjaHN0YXJ0JyArIG5hbWVzcGFjZSwgZnVuY3Rpb24gKGV2ZW50KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHRvdWNoID0gZXZlbnQub3JpZ2luYWxFdmVudC50b3VjaGVzICYmIGV2ZW50Lm9yaWdpbmFsRXZlbnQudG91Y2hlc1swXSB8fCBldmVudDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgb3JpZ2luYWxUb3VjaCA9IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJwYWdlWFwiOiB0b3VjaC5wYWdlWCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJwYWdlWVwiOiB0b3VjaC5wYWdlWVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIG9yaWdpbmFsU2Nyb2xsID0ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcImxlZnRcIjogYy5zY3JvbGxMZWZ0KCksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwidG9wXCI6IGMuc2Nyb2xsVG9wKClcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICQoZG9jdW1lbnQpLm9uKCd0b3VjaG1vdmUnICsgbmFtZXNwYWNlLCBmdW5jdGlvbiAoZXZlbnQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHRvdWNoID0gZXZlbnQub3JpZ2luYWxFdmVudC50YXJnZXRUb3VjaGVzICYmIGV2ZW50Lm9yaWdpbmFsRXZlbnQudGFyZ2V0VG91Y2hlc1swXSB8fCBldmVudDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYy5zY3JvbGxMZWZ0KG9yaWdpbmFsU2Nyb2xsLmxlZnQgKyBvcmlnaW5hbFRvdWNoLnBhZ2VYIC0gdG91Y2gucGFnZVgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjLnNjcm9sbFRvcChvcmlnaW5hbFNjcm9sbC50b3AgKyBvcmlnaW5hbFRvdWNoLnBhZ2VZIC0gdG91Y2gucGFnZVkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICQoZG9jdW1lbnQpLm9uKCd0b3VjaGVuZCcgKyBuYW1lc3BhY2UsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJChkb2N1bWVudCkub2ZmKG5hbWVzcGFjZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAoJC5pc0Z1bmN0aW9uKG8ub25Jbml0KSl7XG4gICAgICAgICAgICAgICAgICAgIG8ub25Jbml0LmFwcGx5KHRoaXMsIFtjXSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBjdy5jc3Moe1xuICAgICAgICAgICAgICAgICAgICBcImhlaWdodFwiOiBcImF1dG9cIixcbiAgICAgICAgICAgICAgICAgICAgXCJtYXJnaW4tYm90dG9tXCI6IGJyb3dzZXIuc2Nyb2xsLmhlaWdodCAqIC0xICsgJ3B4JyxcbiAgICAgICAgICAgICAgICAgICAgXCJtYXJnaW4tcmlnaHRcIjogYnJvd3Nlci5zY3JvbGwud2lkdGggKiAtMSArICdweCcsXG4gICAgICAgICAgICAgICAgICAgIFwibWF4LWhlaWdodFwiOiBcIlwiXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vIGluaXQgc2Nyb2xsYmFycyAmIHJlY2FsY3VsYXRlIHNpemVzXG4gICAgICAgICAgICAkLmVhY2gocywgZnVuY3Rpb24gKGQsIHNjcm9sbHgpIHtcblxuICAgICAgICAgICAgICAgIHZhciBzY3JvbGxDYWxsYmFjayA9IG51bGw7XG4gICAgICAgICAgICAgICAgdmFyIHNjcm9sbEZvcndhcmQgPSAxO1xuICAgICAgICAgICAgICAgIHZhciBzY3JvbGxPZmZzZXQgPSAoZCA9PT0gJ3gnKSA/ICdzY3JvbGxMZWZ0JyA6ICdzY3JvbGxUb3AnO1xuICAgICAgICAgICAgICAgIHZhciBzY3JvbGxTdGVwID0gby5zY3JvbGxTdGVwO1xuICAgICAgICAgICAgICAgIHZhciBzY3JvbGxUbyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGN1cnJlbnRPZmZzZXQgPSBjW3Njcm9sbE9mZnNldF0oKTtcbiAgICAgICAgICAgICAgICAgICAgY1tzY3JvbGxPZmZzZXRdKGN1cnJlbnRPZmZzZXQgKyBzY3JvbGxTdGVwKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHNjcm9sbEZvcndhcmQgPT0gMSAmJiAoY3VycmVudE9mZnNldCArIHNjcm9sbFN0ZXApID49IHNjcm9sbFRvVmFsdWUpXG4gICAgICAgICAgICAgICAgICAgICAgICBjdXJyZW50T2Zmc2V0ID0gY1tzY3JvbGxPZmZzZXRdKCk7XG4gICAgICAgICAgICAgICAgICAgIGlmIChzY3JvbGxGb3J3YXJkID09IC0xICYmIChjdXJyZW50T2Zmc2V0ICsgc2Nyb2xsU3RlcCkgPD0gc2Nyb2xsVG9WYWx1ZSlcbiAgICAgICAgICAgICAgICAgICAgICAgIGN1cnJlbnRPZmZzZXQgPSBjW3Njcm9sbE9mZnNldF0oKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGNbc2Nyb2xsT2Zmc2V0XSgpID09IGN1cnJlbnRPZmZzZXQgJiYgc2Nyb2xsQ2FsbGJhY2spIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHNjcm9sbENhbGxiYWNrKCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdmFyIHNjcm9sbFRvVmFsdWUgPSAwO1xuXG4gICAgICAgICAgICAgICAgaWYgKCFzY3JvbGx4LnNjcm9sbCkge1xuXG4gICAgICAgICAgICAgICAgICAgIHNjcm9sbHguc2Nyb2xsID0gUy5fZ2V0U2Nyb2xsKG9bJ3Njcm9sbCcgKyBkXSkuYWRkQ2xhc3MoJ3Njcm9sbC0nICsgZCk7XG5cbiAgICAgICAgICAgICAgICAgICAgaWYoby5zaG93QXJyb3dzKXtcbiAgICAgICAgICAgICAgICAgICAgICAgIHNjcm9sbHguc2Nyb2xsLmFkZENsYXNzKCdzY3JvbGwtZWxlbWVudF9hcnJvd3NfdmlzaWJsZScpO1xuICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgc2Nyb2xseC5tb3VzZXdoZWVsID0gZnVuY3Rpb24gKGV2ZW50KSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghc2Nyb2xseC5pc1Zpc2libGUgfHwgKGQgPT09ICd4JyAmJiBpc1ZlcnRpY2FsU2Nyb2xsKGV2ZW50KSkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChkID09PSAneScgJiYgIWlzVmVydGljYWxTY3JvbGwoZXZlbnQpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcy54Lm1vdXNld2hlZWwoZXZlbnQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgZGVsdGEgPSBldmVudC5vcmlnaW5hbEV2ZW50LndoZWVsRGVsdGEgKiAtMSB8fCBldmVudC5vcmlnaW5hbEV2ZW50LmRldGFpbDtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBtYXhTY3JvbGxWYWx1ZSA9IHNjcm9sbHguc2l6ZSAtIHNjcm9sbHgudmlzaWJsZSAtIHNjcm9sbHgub2Zmc2V0O1xuXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoKGRlbHRhID4gMCAmJiBzY3JvbGxUb1ZhbHVlIDwgbWF4U2Nyb2xsVmFsdWUpIHx8IChkZWx0YSA8IDAgJiYgc2Nyb2xsVG9WYWx1ZSA+IDApKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc2Nyb2xsVG9WYWx1ZSA9IHNjcm9sbFRvVmFsdWUgKyBkZWx0YTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoc2Nyb2xsVG9WYWx1ZSA8IDApXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNjcm9sbFRvVmFsdWUgPSAwO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChzY3JvbGxUb1ZhbHVlID4gbWF4U2Nyb2xsVmFsdWUpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNjcm9sbFRvVmFsdWUgPSBtYXhTY3JvbGxWYWx1ZTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFMuc2Nyb2xsVG8gPSBTLnNjcm9sbFRvIHx8IHt9O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFMuc2Nyb2xsVG9bc2Nyb2xsT2Zmc2V0XSA9IHNjcm9sbFRvVmFsdWU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChTLnNjcm9sbFRvKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjLnN0b3AoKS5hbmltYXRlKFMuc2Nyb2xsVG8sIDI0MCwgJ2xpbmVhcicsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzY3JvbGxUb1ZhbHVlID0gY1tzY3JvbGxPZmZzZXRdKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFMuc2Nyb2xsVG8gPSBudWxsO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSwgMSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgICAgICAgICAgc2Nyb2xseC5zY3JvbGxcbiAgICAgICAgICAgICAgICAgICAgICAgIC5vbignTW96TW91c2VQaXhlbFNjcm9sbCcgKyBuYW1lc3BhY2UsIHNjcm9sbHgubW91c2V3aGVlbClcbiAgICAgICAgICAgICAgICAgICAgICAgIC5vbignbW91c2V3aGVlbCcgKyBuYW1lc3BhY2UsIHNjcm9sbHgubW91c2V3aGVlbClcbiAgICAgICAgICAgICAgICAgICAgICAgIC5vbignbW91c2VlbnRlcicgKyBuYW1lc3BhY2UsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzY3JvbGxUb1ZhbHVlID0gY1tzY3JvbGxPZmZzZXRdKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgICAgICAvLyBoYW5kbGUgYXJyb3dzICYgc2Nyb2xsIGlubmVyIG1vdXNlZG93biBldmVudFxuICAgICAgICAgICAgICAgICAgICBzY3JvbGx4LnNjcm9sbC5maW5kKCcuc2Nyb2xsLWFycm93LCAuc2Nyb2xsLWVsZW1lbnRfdHJhY2snKVxuICAgICAgICAgICAgICAgICAgICAgICAgLm9uKCdtb3VzZWRvd24nICsgbmFtZXNwYWNlLCBmdW5jdGlvbiAoZXZlbnQpIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChldmVudC53aGljaCAhPSAxKSAvLyBsbWJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzY3JvbGxGb3J3YXJkID0gMTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBkYXRhID0ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcImV2ZW50T2Zmc2V0XCI6IGV2ZW50WyhkID09PSAneCcpID8gJ3BhZ2VYJyA6ICdwYWdlWSddLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIm1heFNjcm9sbFZhbHVlXCI6IHNjcm9sbHguc2l6ZSAtIHNjcm9sbHgudmlzaWJsZSAtIHNjcm9sbHgub2Zmc2V0LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcInNjcm9sbGJhck9mZnNldFwiOiBzY3JvbGx4LnNjcm9sbC5iYXIub2Zmc2V0KClbKGQgPT09ICd4JykgPyAnbGVmdCcgOiAndG9wJ10sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwic2Nyb2xsYmFyU2l6ZVwiOiBzY3JvbGx4LnNjcm9sbC5iYXJbKGQgPT09ICd4JykgPyAnb3V0ZXJXaWR0aCcgOiAnb3V0ZXJIZWlnaHQnXSgpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgdGltZW91dCA9IDAsIHRpbWVyID0gMDtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICgkKHRoaXMpLmhhc0NsYXNzKCdzY3JvbGwtYXJyb3cnKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzY3JvbGxGb3J3YXJkID0gJCh0aGlzKS5oYXNDbGFzcyhcInNjcm9sbC1hcnJvd19tb3JlXCIpID8gMSA6IC0xO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzY3JvbGxTdGVwID0gby5zY3JvbGxTdGVwICogc2Nyb2xsRm9yd2FyZDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2Nyb2xsVG9WYWx1ZSA9IHNjcm9sbEZvcndhcmQgPiAwID8gZGF0YS5tYXhTY3JvbGxWYWx1ZSA6IDA7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2Nyb2xsRm9yd2FyZCA9IChkYXRhLmV2ZW50T2Zmc2V0ID4gKGRhdGEuc2Nyb2xsYmFyT2Zmc2V0ICsgZGF0YS5zY3JvbGxiYXJTaXplKSA/IDFcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDogKGRhdGEuZXZlbnRPZmZzZXQgPCBkYXRhLnNjcm9sbGJhck9mZnNldCA/IC0xIDogMCkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzY3JvbGxTdGVwID0gTWF0aC5yb3VuZChzY3JvbGx4LnZpc2libGUgKiAwLjc1KSAqIHNjcm9sbEZvcndhcmQ7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNjcm9sbFRvVmFsdWUgPSAoZGF0YS5ldmVudE9mZnNldCAtIGRhdGEuc2Nyb2xsYmFyT2Zmc2V0IC1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIChvLnN0ZXBTY3JvbGxpbmcgPyAoc2Nyb2xsRm9yd2FyZCA9PSAxID8gZGF0YS5zY3JvbGxiYXJTaXplIDogMClcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA6IE1hdGgucm91bmQoZGF0YS5zY3JvbGxiYXJTaXplIC8gMikpKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2Nyb2xsVG9WYWx1ZSA9IGNbc2Nyb2xsT2Zmc2V0XSgpICsgKHNjcm9sbFRvVmFsdWUgLyBzY3JvbGx4Lmt4KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBTLnNjcm9sbFRvID0gUy5zY3JvbGxUbyB8fCB7fTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBTLnNjcm9sbFRvW3Njcm9sbE9mZnNldF0gPSBvLnN0ZXBTY3JvbGxpbmcgPyBjW3Njcm9sbE9mZnNldF0oKSArIHNjcm9sbFN0ZXAgOiBzY3JvbGxUb1ZhbHVlO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG8uc3RlcFNjcm9sbGluZykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzY3JvbGxDYWxsYmFjayA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNjcm9sbFRvVmFsdWUgPSBjW3Njcm9sbE9mZnNldF0oKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNsZWFySW50ZXJ2YWwodGltZXIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2xlYXJUaW1lb3V0KHRpbWVvdXQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGltZW91dCA9IDA7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aW1lciA9IDA7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRpbWVvdXQgPSBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRpbWVyID0gc2V0SW50ZXJ2YWwoc2Nyb2xsVG8sIDQwKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSwgby5kdXJhdGlvbiArIDEwMCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChTLnNjcm9sbFRvKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjLmFuaW1hdGUoUy5zY3JvbGxUbywgby5kdXJhdGlvbik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBTLnNjcm9sbFRvID0gbnVsbDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sIDEpO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFMuX2hhbmRsZU1vdXNlRG93bihzY3JvbGxDYWxsYmFjaywgZXZlbnQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICAgICAgLy8gaGFuZGxlIHNjcm9sbGJhciBkcmFnJ24nZHJvcFxuICAgICAgICAgICAgICAgICAgICBzY3JvbGx4LnNjcm9sbC5iYXIub24oJ21vdXNlZG93bicgKyBuYW1lc3BhY2UsIGZ1bmN0aW9uIChldmVudCkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoZXZlbnQud2hpY2ggIT0gMSkgLy8gbG1iXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBldmVudFBvc2l0aW9uID0gZXZlbnRbKGQgPT09ICd4JykgPyAncGFnZVgnIDogJ3BhZ2VZJ107XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgaW5pdE9mZnNldCA9IGNbc2Nyb2xsT2Zmc2V0XSgpO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICBzY3JvbGx4LnNjcm9sbC5hZGRDbGFzcygnc2Nyb2xsLWRyYWdnYWJsZScpO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAkKGRvY3VtZW50KS5vbignbW91c2Vtb3ZlJyArIG5hbWVzcGFjZSwgZnVuY3Rpb24gKGV2ZW50KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGRpZmYgPSBwYXJzZUludCgoZXZlbnRbKGQgPT09ICd4JykgPyAncGFnZVgnIDogJ3BhZ2VZJ10gLSBldmVudFBvc2l0aW9uKSAvIHNjcm9sbHgua3gsIDEwKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjW3Njcm9sbE9mZnNldF0oaW5pdE9mZnNldCArIGRpZmYpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBTLl9oYW5kbGVNb3VzZURvd24oZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNjcm9sbHguc2Nyb2xsLnJlbW92ZUNsYXNzKCdzY3JvbGwtZHJhZ2dhYmxlJyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc2Nyb2xsVG9WYWx1ZSA9IGNbc2Nyb2xsT2Zmc2V0XSgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSwgZXZlbnQpO1xuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgLy8gcmVtb3ZlIGNsYXNzZXMgJiByZXNldCBhcHBsaWVkIHN0eWxlc1xuICAgICAgICAgICAgJC5lYWNoKHMsIGZ1bmN0aW9uIChkLCBzY3JvbGx4KSB7XG4gICAgICAgICAgICAgICAgdmFyIHNjcm9sbENsYXNzID0gJ3Njcm9sbC1zY3JvbGwnICsgZCArICdfdmlzaWJsZSc7XG4gICAgICAgICAgICAgICAgdmFyIHNjcm9sbHkgPSAoZCA9PSBcInhcIikgPyBzLnkgOiBzLng7XG5cbiAgICAgICAgICAgICAgICBzY3JvbGx4LnNjcm9sbC5yZW1vdmVDbGFzcyhzY3JvbGxDbGFzcyk7XG4gICAgICAgICAgICAgICAgc2Nyb2xseS5zY3JvbGwucmVtb3ZlQ2xhc3Moc2Nyb2xsQ2xhc3MpO1xuICAgICAgICAgICAgICAgIGN3LnJlbW92ZUNsYXNzKHNjcm9sbENsYXNzKTtcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAvLyBjYWxjdWxhdGUgaW5pdCBzaXplc1xuICAgICAgICAgICAgJC5lYWNoKHMsIGZ1bmN0aW9uIChkLCBzY3JvbGx4KSB7XG4gICAgICAgICAgICAgICAgJC5leHRlbmQoc2Nyb2xseCwgKGQgPT0gXCJ4XCIpID8ge1xuICAgICAgICAgICAgICAgICAgICBcIm9mZnNldFwiOiBwYXJzZUludChjLmNzcygnbGVmdCcpLCAxMCkgfHwgMCxcbiAgICAgICAgICAgICAgICAgICAgXCJzaXplXCI6IGMucHJvcCgnc2Nyb2xsV2lkdGgnKSxcbiAgICAgICAgICAgICAgICAgICAgXCJ2aXNpYmxlXCI6IHcud2lkdGgoKVxuICAgICAgICAgICAgICAgIH0gOiB7XG4gICAgICAgICAgICAgICAgICAgIFwib2Zmc2V0XCI6IHBhcnNlSW50KGMuY3NzKCd0b3AnKSwgMTApIHx8IDAsXG4gICAgICAgICAgICAgICAgICAgIFwic2l6ZVwiOiBjLnByb3AoJ3Njcm9sbEhlaWdodCcpLFxuICAgICAgICAgICAgICAgICAgICBcInZpc2libGVcIjogdy5oZWlnaHQoKVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIC8vIHVwZGF0ZSBzY3JvbGxiYXIgdmlzaWJpbGl0eS9kaW1lbnNpb25zXG4gICAgICAgICAgICB0aGlzLl91cGRhdGVTY3JvbGwoJ3gnLCB0aGlzLnNjcm9sbHgpO1xuICAgICAgICAgICAgdGhpcy5fdXBkYXRlU2Nyb2xsKCd5JywgdGhpcy5zY3JvbGx5KTtcblxuICAgICAgICAgICAgaWYgKCQuaXNGdW5jdGlvbihvLm9uVXBkYXRlKSl7XG4gICAgICAgICAgICAgICAgby5vblVwZGF0ZS5hcHBseSh0aGlzLCBbY10pO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvLyBjYWxjdWxhdGUgc2Nyb2xsIHNpemVcbiAgICAgICAgICAgICQuZWFjaChzLCBmdW5jdGlvbiAoZCwgc2Nyb2xseCkge1xuXG4gICAgICAgICAgICAgICAgdmFyIGNzc09mZnNldCA9IChkID09PSAneCcpID8gJ2xlZnQnIDogJ3RvcCc7XG4gICAgICAgICAgICAgICAgdmFyIGNzc0Z1bGxTaXplID0gKGQgPT09ICd4JykgPyAnb3V0ZXJXaWR0aCcgOiAnb3V0ZXJIZWlnaHQnO1xuICAgICAgICAgICAgICAgIHZhciBjc3NTaXplID0gKGQgPT09ICd4JykgPyAnd2lkdGgnIDogJ2hlaWdodCc7XG4gICAgICAgICAgICAgICAgdmFyIG9mZnNldCA9IHBhcnNlSW50KGMuY3NzKGNzc09mZnNldCksIDEwKSB8fCAwO1xuXG4gICAgICAgICAgICAgICAgdmFyIEFyZWFTaXplID0gc2Nyb2xseC5zaXplO1xuICAgICAgICAgICAgICAgIHZhciBBcmVhVmlzaWJsZSA9IHNjcm9sbHgudmlzaWJsZSArIG9mZnNldDtcblxuICAgICAgICAgICAgICAgIHZhciBzY3JvbGxTaXplID0gc2Nyb2xseC5zY3JvbGwuc2l6ZVtjc3NGdWxsU2l6ZV0oKSArIChwYXJzZUludChzY3JvbGx4LnNjcm9sbC5zaXplLmNzcyhjc3NPZmZzZXQpLCAxMCkgfHwgMCk7XG5cbiAgICAgICAgICAgICAgICBpZiAoby5hdXRvU2Nyb2xsU2l6ZSkge1xuICAgICAgICAgICAgICAgICAgICBzY3JvbGx4LnNjcm9sbGJhclNpemUgPSBwYXJzZUludChzY3JvbGxTaXplICogQXJlYVZpc2libGUgLyBBcmVhU2l6ZSwgMTApO1xuICAgICAgICAgICAgICAgICAgICBzY3JvbGx4LnNjcm9sbC5iYXIuY3NzKGNzc1NpemUsIHNjcm9sbHguc2Nyb2xsYmFyU2l6ZSArICdweCcpO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIHNjcm9sbHguc2Nyb2xsYmFyU2l6ZSA9IHNjcm9sbHguc2Nyb2xsLmJhcltjc3NGdWxsU2l6ZV0oKTtcbiAgICAgICAgICAgICAgICBzY3JvbGx4Lmt4ID0gKChzY3JvbGxTaXplIC0gc2Nyb2xseC5zY3JvbGxiYXJTaXplKSAvIChBcmVhU2l6ZSAtIEFyZWFWaXNpYmxlKSkgfHwgMTtcbiAgICAgICAgICAgICAgICBzY3JvbGx4Lm1heFNjcm9sbE9mZnNldCA9IEFyZWFTaXplIC0gQXJlYVZpc2libGU7XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgYy5zY3JvbGxMZWZ0KGluaXRTY3JvbGwuc2Nyb2xsTGVmdCkuc2Nyb2xsVG9wKGluaXRTY3JvbGwuc2Nyb2xsVG9wKS50cmlnZ2VyKCdzY3JvbGwnKTtcbiAgICAgICAgfSxcblxuICAgICAgICAvKipcbiAgICAgICAgICogR2V0IHNjcm9sbHgvc2Nyb2xseSBvYmplY3RcbiAgICAgICAgICpcbiAgICAgICAgICogQHBhcmFtIHtNaXhlZH0gc2Nyb2xsXG4gICAgICAgICAqIEByZXR1cm5zIHtqUXVlcnl9IHNjcm9sbCBvYmplY3RcbiAgICAgICAgICovXG4gICAgICAgIF9nZXRTY3JvbGw6IGZ1bmN0aW9uIChzY3JvbGwpIHtcbiAgICAgICAgICAgIHZhciB0eXBlcyA9IHtcbiAgICAgICAgICAgICAgICBhZHZhbmNlZDogW1xuICAgICAgICAgICAgICAgICAgICAnPGRpdiBjbGFzcz1cInNjcm9sbC1lbGVtZW50XCI+JyxcbiAgICAgICAgICAgICAgICAgICAgJzxkaXYgY2xhc3M9XCJzY3JvbGwtZWxlbWVudF9jb3JuZXJcIj48L2Rpdj4nLFxuICAgICAgICAgICAgICAgICAgICAnPGRpdiBjbGFzcz1cInNjcm9sbC1hcnJvdyBzY3JvbGwtYXJyb3dfbGVzc1wiPjwvZGl2PicsXG4gICAgICAgICAgICAgICAgICAgICc8ZGl2IGNsYXNzPVwic2Nyb2xsLWFycm93IHNjcm9sbC1hcnJvd19tb3JlXCI+PC9kaXY+JyxcbiAgICAgICAgICAgICAgICAgICAgJzxkaXYgY2xhc3M9XCJzY3JvbGwtZWxlbWVudF9vdXRlclwiPicsXG4gICAgICAgICAgICAgICAgICAgICc8ZGl2IGNsYXNzPVwic2Nyb2xsLWVsZW1lbnRfc2l6ZVwiPjwvZGl2PicsIC8vIHJlcXVpcmVkISB1c2VkIGZvciBzY3JvbGxiYXIgc2l6ZSBjYWxjdWxhdGlvbiAhXG4gICAgICAgICAgICAgICAgICAgICc8ZGl2IGNsYXNzPVwic2Nyb2xsLWVsZW1lbnRfaW5uZXItd3JhcHBlclwiPicsXG4gICAgICAgICAgICAgICAgICAgICc8ZGl2IGNsYXNzPVwic2Nyb2xsLWVsZW1lbnRfaW5uZXIgc2Nyb2xsLWVsZW1lbnRfdHJhY2tcIj4nLCAvLyB1c2VkIGZvciBoYW5kbGluZyBzY3JvbGxiYXIgY2xpY2tcbiAgICAgICAgICAgICAgICAgICAgJzxkaXYgY2xhc3M9XCJzY3JvbGwtZWxlbWVudF9pbm5lci1ib3R0b21cIj48L2Rpdj4nLFxuICAgICAgICAgICAgICAgICAgICAnPC9kaXY+JyxcbiAgICAgICAgICAgICAgICAgICAgJzwvZGl2PicsXG4gICAgICAgICAgICAgICAgICAgICc8ZGl2IGNsYXNzPVwic2Nyb2xsLWJhclwiPicsIC8vIHJlcXVpcmVkXG4gICAgICAgICAgICAgICAgICAgICc8ZGl2IGNsYXNzPVwic2Nyb2xsLWJhcl9ib2R5XCI+JyxcbiAgICAgICAgICAgICAgICAgICAgJzxkaXYgY2xhc3M9XCJzY3JvbGwtYmFyX2JvZHktaW5uZXJcIj48L2Rpdj4nLFxuICAgICAgICAgICAgICAgICAgICAnPC9kaXY+JyxcbiAgICAgICAgICAgICAgICAgICAgJzxkaXYgY2xhc3M9XCJzY3JvbGwtYmFyX2JvdHRvbVwiPjwvZGl2PicsXG4gICAgICAgICAgICAgICAgICAgICc8ZGl2IGNsYXNzPVwic2Nyb2xsLWJhcl9jZW50ZXJcIj48L2Rpdj4nLFxuICAgICAgICAgICAgICAgICAgICAnPC9kaXY+JyxcbiAgICAgICAgICAgICAgICAgICAgJzwvZGl2PicsXG4gICAgICAgICAgICAgICAgICAgICc8L2Rpdj4nXG4gICAgICAgICAgICAgICAgXS5qb2luKCcnKSxcbiAgICAgICAgICAgICAgICBzaW1wbGU6IFtcbiAgICAgICAgICAgICAgICAgICAgJzxkaXYgY2xhc3M9XCJzY3JvbGwtZWxlbWVudFwiPicsXG4gICAgICAgICAgICAgICAgICAgICc8ZGl2IGNsYXNzPVwic2Nyb2xsLWVsZW1lbnRfb3V0ZXJcIj4nLFxuICAgICAgICAgICAgICAgICAgICAnPGRpdiBjbGFzcz1cInNjcm9sbC1lbGVtZW50X3NpemVcIj48L2Rpdj4nLCAvLyByZXF1aXJlZCEgdXNlZCBmb3Igc2Nyb2xsYmFyIHNpemUgY2FsY3VsYXRpb24gIVxuICAgICAgICAgICAgICAgICAgICAnPGRpdiBjbGFzcz1cInNjcm9sbC1lbGVtZW50X3RyYWNrXCI+PC9kaXY+JywgLy8gdXNlZCBmb3IgaGFuZGxpbmcgc2Nyb2xsYmFyIGNsaWNrXG4gICAgICAgICAgICAgICAgICAgICc8ZGl2IGNsYXNzPVwic2Nyb2xsLWJhclwiPjwvZGl2PicsIC8vIHJlcXVpcmVkXG4gICAgICAgICAgICAgICAgICAgICc8L2Rpdj4nLFxuICAgICAgICAgICAgICAgICAgICAnPC9kaXY+J1xuICAgICAgICAgICAgICAgIF0uam9pbignJylcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICBpZiAodHlwZXNbc2Nyb2xsXSkge1xuICAgICAgICAgICAgICAgIHNjcm9sbCA9IHR5cGVzW3Njcm9sbF07XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoIXNjcm9sbCkge1xuICAgICAgICAgICAgICAgIHNjcm9sbCA9IHR5cGVzWydzaW1wbGUnXTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICh0eXBlb2YgKHNjcm9sbCkgPT0gJ3N0cmluZycpIHtcbiAgICAgICAgICAgICAgICBzY3JvbGwgPSAkKHNjcm9sbCkuYXBwZW5kVG8odGhpcy53cmFwcGVyKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgc2Nyb2xsID0gJChzY3JvbGwpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgJC5leHRlbmQoc2Nyb2xsLCB7XG4gICAgICAgICAgICAgICAgYmFyOiBzY3JvbGwuZmluZCgnLnNjcm9sbC1iYXInKSxcbiAgICAgICAgICAgICAgICBzaXplOiBzY3JvbGwuZmluZCgnLnNjcm9sbC1lbGVtZW50X3NpemUnKSxcbiAgICAgICAgICAgICAgICB0cmFjazogc2Nyb2xsLmZpbmQoJy5zY3JvbGwtZWxlbWVudF90cmFjaycpXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHJldHVybiBzY3JvbGw7XG4gICAgICAgIH0sXG5cbiAgICAgICAgX2hhbmRsZU1vdXNlRG93bjogZnVuY3Rpb24oY2FsbGJhY2ssIGV2ZW50KSB7XG5cbiAgICAgICAgICAgIHZhciBuYW1lc3BhY2UgPSB0aGlzLm5hbWVzcGFjZTtcblxuICAgICAgICAgICAgJChkb2N1bWVudCkub24oJ2JsdXInICsgbmFtZXNwYWNlLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgJChkb2N1bWVudCkuYWRkKCdib2R5Jykub2ZmKG5hbWVzcGFjZSk7XG4gICAgICAgICAgICAgICAgY2FsbGJhY2sgJiYgY2FsbGJhY2soKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgJChkb2N1bWVudCkub24oJ2RyYWdzdGFydCcgKyBuYW1lc3BhY2UsIGZ1bmN0aW9uIChldmVudCkge1xuICAgICAgICAgICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAkKGRvY3VtZW50KS5vbignbW91c2V1cCcgKyBuYW1lc3BhY2UsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAkKGRvY3VtZW50KS5hZGQoJ2JvZHknKS5vZmYobmFtZXNwYWNlKTtcbiAgICAgICAgICAgICAgICBjYWxsYmFjayAmJiBjYWxsYmFjaygpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAkKCdib2R5Jykub24oJ3NlbGVjdHN0YXJ0JyArIG5hbWVzcGFjZSwgZnVuY3Rpb24gKGV2ZW50KSB7XG4gICAgICAgICAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgZXZlbnQgJiYgZXZlbnQucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfSxcblxuICAgICAgICBfdXBkYXRlU2Nyb2xsOiBmdW5jdGlvbiAoZCwgc2Nyb2xseCkge1xuXG4gICAgICAgICAgICB2YXIgY29udGFpbmVyID0gdGhpcy5jb250YWluZXIsXG4gICAgICAgICAgICAgICAgY29udGFpbmVyV3JhcHBlciA9IHRoaXMuY29udGFpbmVyV3JhcHBlciB8fCBjb250YWluZXIsXG4gICAgICAgICAgICAgICAgc2Nyb2xsQ2xhc3MgPSAnc2Nyb2xsLXNjcm9sbCcgKyBkICsgJ192aXNpYmxlJyxcbiAgICAgICAgICAgICAgICBzY3JvbGx5ID0gKGQgPT09ICd4JykgPyB0aGlzLnNjcm9sbHkgOiB0aGlzLnNjcm9sbHgsXG4gICAgICAgICAgICAgICAgb2Zmc2V0ID0gcGFyc2VJbnQodGhpcy5jb250YWluZXIuY3NzKChkID09PSAneCcpID8gJ2xlZnQnIDogJ3RvcCcpLCAxMCkgfHwgMCxcbiAgICAgICAgICAgICAgICB3cmFwcGVyID0gdGhpcy53cmFwcGVyO1xuXG4gICAgICAgICAgICB2YXIgQXJlYVNpemUgPSBzY3JvbGx4LnNpemU7XG4gICAgICAgICAgICB2YXIgQXJlYVZpc2libGUgPSBzY3JvbGx4LnZpc2libGUgKyBvZmZzZXQ7XG5cbiAgICAgICAgICAgIHNjcm9sbHguaXNWaXNpYmxlID0gKEFyZWFTaXplIC0gQXJlYVZpc2libGUpID4gMTsgLy8gYnVnIGluIElFOS8xMSB3aXRoIDFweCBkaWZmXG4gICAgICAgICAgICBpZiAoc2Nyb2xseC5pc1Zpc2libGUpIHtcbiAgICAgICAgICAgICAgICBzY3JvbGx4LnNjcm9sbC5hZGRDbGFzcyhzY3JvbGxDbGFzcyk7XG4gICAgICAgICAgICAgICAgc2Nyb2xseS5zY3JvbGwuYWRkQ2xhc3Moc2Nyb2xsQ2xhc3MpO1xuICAgICAgICAgICAgICAgIGNvbnRhaW5lcldyYXBwZXIuYWRkQ2xhc3Moc2Nyb2xsQ2xhc3MpO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBzY3JvbGx4LnNjcm9sbC5yZW1vdmVDbGFzcyhzY3JvbGxDbGFzcyk7XG4gICAgICAgICAgICAgICAgc2Nyb2xseS5zY3JvbGwucmVtb3ZlQ2xhc3Moc2Nyb2xsQ2xhc3MpO1xuICAgICAgICAgICAgICAgIGNvbnRhaW5lcldyYXBwZXIucmVtb3ZlQ2xhc3Moc2Nyb2xsQ2xhc3MpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBpZiAoZCA9PT0gJ3knKSB7XG4gICAgICAgICAgICAgICAgaWYoY29udGFpbmVyLmlzKCd0ZXh0YXJlYScpIHx8IEFyZWFTaXplIDwgQXJlYVZpc2libGUpe1xuICAgICAgICAgICAgICAgICAgICBjb250YWluZXJXcmFwcGVyLmNzcyh7XG4gICAgICAgICAgICAgICAgICAgICAgICBcImhlaWdodFwiOiAoQXJlYVZpc2libGUgKyBicm93c2VyLnNjcm9sbC5oZWlnaHQpICsgJ3B4JyxcbiAgICAgICAgICAgICAgICAgICAgICAgIFwibWF4LWhlaWdodFwiOiBcIm5vbmVcIlxuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBjb250YWluZXJXcmFwcGVyLmNzcyh7XG4gICAgICAgICAgICAgICAgICAgICAgICAvL1wiaGVpZ2h0XCI6IFwiYXV0b1wiLCAvLyBkbyBub3QgcmVzZXQgaGVpZ2h0IHZhbHVlOiBpc3N1ZSB3aXRoIGhlaWdodDoxMDAlIVxuICAgICAgICAgICAgICAgICAgICAgICAgXCJtYXgtaGVpZ2h0XCI6IChBcmVhVmlzaWJsZSArIGJyb3dzZXIuc2Nyb2xsLmhlaWdodCkgKyAncHgnXG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgaWYgKHNjcm9sbHguc2l6ZSAhPSBjb250YWluZXIucHJvcCgnc2Nyb2xsV2lkdGgnKVxuICAgICAgICAgICAgICAgIHx8IHNjcm9sbHkuc2l6ZSAhPSBjb250YWluZXIucHJvcCgnc2Nyb2xsSGVpZ2h0JylcbiAgICAgICAgICAgICAgICB8fCBzY3JvbGx4LnZpc2libGUgIT0gd3JhcHBlci53aWR0aCgpXG4gICAgICAgICAgICAgICAgfHwgc2Nyb2xseS52aXNpYmxlICE9IHdyYXBwZXIuaGVpZ2h0KClcbiAgICAgICAgICAgICAgICB8fCBzY3JvbGx4Lm9mZnNldCAhPSAocGFyc2VJbnQoY29udGFpbmVyLmNzcygnbGVmdCcpLCAxMCkgfHwgMClcbiAgICAgICAgICAgICAgICB8fCBzY3JvbGx5Lm9mZnNldCAhPSAocGFyc2VJbnQoY29udGFpbmVyLmNzcygndG9wJyksIDEwKSB8fCAwKVxuICAgICAgICAgICAgICAgICkge1xuICAgICAgICAgICAgICAgICQuZXh0ZW5kKHRoaXMuc2Nyb2xseCwge1xuICAgICAgICAgICAgICAgICAgICBcIm9mZnNldFwiOiBwYXJzZUludChjb250YWluZXIuY3NzKCdsZWZ0JyksIDEwKSB8fCAwLFxuICAgICAgICAgICAgICAgICAgICBcInNpemVcIjogY29udGFpbmVyLnByb3AoJ3Njcm9sbFdpZHRoJyksXG4gICAgICAgICAgICAgICAgICAgIFwidmlzaWJsZVwiOiB3cmFwcGVyLndpZHRoKClcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAkLmV4dGVuZCh0aGlzLnNjcm9sbHksIHtcbiAgICAgICAgICAgICAgICAgICAgXCJvZmZzZXRcIjogcGFyc2VJbnQoY29udGFpbmVyLmNzcygndG9wJyksIDEwKSB8fCAwLFxuICAgICAgICAgICAgICAgICAgICBcInNpemVcIjogdGhpcy5jb250YWluZXIucHJvcCgnc2Nyb2xsSGVpZ2h0JyksXG4gICAgICAgICAgICAgICAgICAgIFwidmlzaWJsZVwiOiB3cmFwcGVyLmhlaWdodCgpXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgdGhpcy5fdXBkYXRlU2Nyb2xsKGQgPT09ICd4JyA/ICd5JyA6ICd4Jywgc2Nyb2xseSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9O1xuXG4gICAgdmFyIEN1c3RvbVNjcm9sbGJhciA9IEJhc2VTY3JvbGxiYXI7XG5cbiAgICAvKlxuICAgICAqIEV4dGVuZCBqUXVlcnkgYXMgcGx1Z2luXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge01peGVkfSBjb21tYW5kIHRvIGV4ZWN1dGVcbiAgICAgKiBAcGFyYW0ge01peGVkfSBhcmd1bWVudHMgYXMgQXJyYXlcbiAgICAgKiBAcmV0dXJuIHtqUXVlcnl9XG4gICAgICovXG4gICAgJC5mbi5zY3JvbGxiYXIgPSBmdW5jdGlvbiAoY29tbWFuZCwgYXJncykge1xuICAgICAgICBpZiAodHlwZW9mIGNvbW1hbmQgIT09ICdzdHJpbmcnKSB7XG4gICAgICAgICAgICBhcmdzID0gY29tbWFuZDtcbiAgICAgICAgICAgIGNvbW1hbmQgPSAnaW5pdCc7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHR5cGVvZiBhcmdzID09PSAndW5kZWZpbmVkJykge1xuICAgICAgICAgICAgYXJncyA9IFtdO1xuICAgICAgICB9XG4gICAgICAgIGlmICghJC5pc0FycmF5KGFyZ3MpKSB7XG4gICAgICAgICAgICBhcmdzID0gW2FyZ3NdO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMubm90KCdib2R5LCAuc2Nyb2xsLXdyYXBwZXInKS5lYWNoKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHZhciBlbGVtZW50ID0gJCh0aGlzKSxcbiAgICAgICAgICAgICAgICBpbnN0YW5jZSA9IGVsZW1lbnQuZGF0YShicm93c2VyLmRhdGEubmFtZSk7XG4gICAgICAgICAgICBpZiAoaW5zdGFuY2UgfHwgY29tbWFuZCA9PT0gJ2luaXQnKSB7XG4gICAgICAgICAgICAgICAgaWYgKCFpbnN0YW5jZSkge1xuICAgICAgICAgICAgICAgICAgICBpbnN0YW5jZSA9IG5ldyBDdXN0b21TY3JvbGxiYXIoZWxlbWVudCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmIChpbnN0YW5jZVtjb21tYW5kXSkge1xuICAgICAgICAgICAgICAgICAgICBpbnN0YW5jZVtjb21tYW5kXS5hcHBseShpbnN0YW5jZSwgYXJncyk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfTtcblxuICAgIC8qKlxuICAgICAqIENvbm5lY3QgZGVmYXVsdCBvcHRpb25zIHRvIGdsb2JhbCBvYmplY3RcbiAgICAgKi9cbiAgICAkLmZuLnNjcm9sbGJhci5vcHRpb25zID0gZGVmYXVsdHM7XG5cblxuICAgIC8qKlxuICAgICAqIENoZWNrIGlmIHNjcm9sbCBjb250ZW50L2NvbnRhaW5lciBzaXplIGlzIGNoYW5nZWRcbiAgICAgKi9cblxuICAgIHZhciB1cGRhdGVTY3JvbGxiYXJzID0gKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIHRpbWVyID0gMCxcbiAgICAgICAgICAgIHRpbWVyQ291bnRlciA9IDA7XG5cbiAgICAgICAgcmV0dXJuIGZ1bmN0aW9uIChmb3JjZSkge1xuICAgICAgICAgICAgdmFyIGksIGNvbnRhaW5lciwgb3B0aW9ucywgc2Nyb2xsLCB3cmFwcGVyLCBzY3JvbGx4LCBzY3JvbGx5O1xuICAgICAgICAgICAgZm9yIChpID0gMDsgaSA8IGJyb3dzZXIuc2Nyb2xscy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgIHNjcm9sbCA9IGJyb3dzZXIuc2Nyb2xsc1tpXTtcbiAgICAgICAgICAgICAgICBjb250YWluZXIgPSBzY3JvbGwuY29udGFpbmVyO1xuICAgICAgICAgICAgICAgIG9wdGlvbnMgPSBzY3JvbGwub3B0aW9ucztcbiAgICAgICAgICAgICAgICB3cmFwcGVyID0gc2Nyb2xsLndyYXBwZXI7XG4gICAgICAgICAgICAgICAgc2Nyb2xseCA9IHNjcm9sbC5zY3JvbGx4O1xuICAgICAgICAgICAgICAgIHNjcm9sbHkgPSBzY3JvbGwuc2Nyb2xseTtcbiAgICAgICAgICAgICAgICBpZiAoZm9yY2UgfHwgKG9wdGlvbnMuYXV0b1VwZGF0ZSAmJiB3cmFwcGVyICYmIHdyYXBwZXIuaXMoJzp2aXNpYmxlJykgJiZcbiAgICAgICAgICAgICAgICAgICAgKGNvbnRhaW5lci5wcm9wKCdzY3JvbGxXaWR0aCcpICE9IHNjcm9sbHguc2l6ZSB8fCBjb250YWluZXIucHJvcCgnc2Nyb2xsSGVpZ2h0JykgIT0gc2Nyb2xseS5zaXplIHx8IHdyYXBwZXIud2lkdGgoKSAhPSBzY3JvbGx4LnZpc2libGUgfHwgd3JhcHBlci5oZWlnaHQoKSAhPSBzY3JvbGx5LnZpc2libGUpKSkge1xuICAgICAgICAgICAgICAgICAgICBzY3JvbGwuaW5pdCgpO1xuXG4gICAgICAgICAgICAgICAgICAgIGlmIChvcHRpb25zLmRlYnVnKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB3aW5kb3cuY29uc29sZSAmJiBjb25zb2xlLmxvZyh7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc2Nyb2xsSGVpZ2h0OiBjb250YWluZXIucHJvcCgnc2Nyb2xsSGVpZ2h0JykgKyAnOicgKyBzY3JvbGwuc2Nyb2xseS5zaXplLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNjcm9sbFdpZHRoOiBjb250YWluZXIucHJvcCgnc2Nyb2xsV2lkdGgnKSArICc6JyArIHNjcm9sbC5zY3JvbGx4LnNpemUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmlzaWJsZUhlaWdodDogd3JhcHBlci5oZWlnaHQoKSArICc6JyArIHNjcm9sbC5zY3JvbGx5LnZpc2libGUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmlzaWJsZVdpZHRoOiB3cmFwcGVyLndpZHRoKCkgKyAnOicgKyBzY3JvbGwuc2Nyb2xseC52aXNpYmxlXG4gICAgICAgICAgICAgICAgICAgICAgICB9LCB0cnVlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRpbWVyQ291bnRlcisrO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKGRlYnVnICYmIHRpbWVyQ291bnRlciA+IDEwKSB7XG4gICAgICAgICAgICAgICAgd2luZG93LmNvbnNvbGUgJiYgY29uc29sZS5sb2coJ1Njcm9sbCB1cGRhdGVzIGV4Y2VlZCAxMCcpO1xuICAgICAgICAgICAgICAgIHVwZGF0ZVNjcm9sbGJhcnMgPSBmdW5jdGlvbiAoKSB7fTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgY2xlYXJUaW1lb3V0KHRpbWVyKTtcbiAgICAgICAgICAgICAgICB0aW1lciA9IHNldFRpbWVvdXQodXBkYXRlU2Nyb2xsYmFycywgMzAwKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICB9KSgpO1xuXG4gICAgLyogQURESVRJT05BTCBGVU5DVElPTlMgKi9cbiAgICAvKipcbiAgICAgKiBHZXQgbmF0aXZlIGJyb3dzZXIgc2Nyb2xsYmFyIHNpemUgKGhlaWdodC93aWR0aClcbiAgICAgKlxuICAgICAqIEBwYXJhbSB7Qm9vbGVhbn0gYWN0dWFsIHNpemUgb3IgQ1NTIHNpemUsIGRlZmF1bHQgLSBDU1Mgc2l6ZVxuICAgICAqIEByZXR1cm5zIHtPYmplY3R9IHdpdGggaGVpZ2h0LCB3aWR0aFxuICAgICAqL1xuICAgIGZ1bmN0aW9uIGdldEJyb3dzZXJTY3JvbGxTaXplKGFjdHVhbFNpemUpIHtcblxuICAgICAgICBpZiAoYnJvd3Nlci53ZWJraXQgJiYgIWFjdHVhbFNpemUpIHtcbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgXCJoZWlnaHRcIjogMCxcbiAgICAgICAgICAgICAgICBcIndpZHRoXCI6IDBcbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoIWJyb3dzZXIuZGF0YS5vdXRlcikge1xuICAgICAgICAgICAgdmFyIGNzcyA9IHtcbiAgICAgICAgICAgICAgICBcImJvcmRlclwiOiBcIm5vbmVcIixcbiAgICAgICAgICAgICAgICBcImJveC1zaXppbmdcIjogXCJjb250ZW50LWJveFwiLFxuICAgICAgICAgICAgICAgIFwiaGVpZ2h0XCI6IFwiMjAwcHhcIixcbiAgICAgICAgICAgICAgICBcIm1hcmdpblwiOiBcIjBcIixcbiAgICAgICAgICAgICAgICBcInBhZGRpbmdcIjogXCIwXCIsXG4gICAgICAgICAgICAgICAgXCJ3aWR0aFwiOiBcIjIwMHB4XCJcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICBicm93c2VyLmRhdGEuaW5uZXIgPSAkKFwiPGRpdj5cIikuY3NzKCQuZXh0ZW5kKHt9LCBjc3MpKTtcbiAgICAgICAgICAgIGJyb3dzZXIuZGF0YS5vdXRlciA9ICQoXCI8ZGl2PlwiKS5jc3MoJC5leHRlbmQoe1xuICAgICAgICAgICAgICAgIFwibGVmdFwiOiBcIi0xMDAwcHhcIixcbiAgICAgICAgICAgICAgICBcIm92ZXJmbG93XCI6IFwic2Nyb2xsXCIsXG4gICAgICAgICAgICAgICAgXCJwb3NpdGlvblwiOiBcImFic29sdXRlXCIsXG4gICAgICAgICAgICAgICAgXCJ0b3BcIjogXCItMTAwMHB4XCJcbiAgICAgICAgICAgIH0sIGNzcykpLmFwcGVuZChicm93c2VyLmRhdGEuaW5uZXIpLmFwcGVuZFRvKFwiYm9keVwiKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGJyb3dzZXIuZGF0YS5vdXRlci5zY3JvbGxMZWZ0KDEwMDApLnNjcm9sbFRvcCgxMDAwKTtcblxuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgXCJoZWlnaHRcIjogTWF0aC5jZWlsKChicm93c2VyLmRhdGEub3V0ZXIub2Zmc2V0KCkudG9wIC0gYnJvd3Nlci5kYXRhLmlubmVyLm9mZnNldCgpLnRvcCkgfHwgMCksXG4gICAgICAgICAgICBcIndpZHRoXCI6IE1hdGguY2VpbCgoYnJvd3Nlci5kYXRhLm91dGVyLm9mZnNldCgpLmxlZnQgLSBicm93c2VyLmRhdGEuaW5uZXIub2Zmc2V0KCkubGVmdCkgfHwgMClcbiAgICAgICAgfTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBDaGVjayBpZiBuYXRpdmUgYnJvd3NlciBzY3JvbGxiYXJzIG92ZXJsYXkgY29udGVudFxuICAgICAqXG4gICAgICogQHJldHVybnMge0Jvb2xlYW59XG4gICAgICovXG4gICAgZnVuY3Rpb24gaXNTY3JvbGxPdmVybGF5c0NvbnRlbnQoKSB7XG4gICAgICAgIHZhciBzY3JvbGxTaXplID0gZ2V0QnJvd3NlclNjcm9sbFNpemUodHJ1ZSk7XG4gICAgICAgIHJldHVybiAhKHNjcm9sbFNpemUuaGVpZ2h0IHx8IHNjcm9sbFNpemUud2lkdGgpO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGlzVmVydGljYWxTY3JvbGwoZXZlbnQpIHtcbiAgICAgICAgdmFyIGUgPSBldmVudC5vcmlnaW5hbEV2ZW50O1xuICAgICAgICBpZiAoZS5heGlzICYmIGUuYXhpcyA9PT0gZS5IT1JJWk9OVEFMX0FYSVMpXG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIGlmIChlLndoZWVsRGVsdGFYKVxuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9XG5cblxuICAgIC8qKlxuICAgICAqIEV4dGVuZCBBbmd1bGFySlMgYXMgVUkgZGlyZWN0aXZlXG4gICAgICogYW5kIGV4cG9zZSBhIHByb3ZpZGVyIGZvciBvdmVycmlkZSBkZWZhdWx0IGNvbmZpZ1xuICAgICAqXG4gICAgICovXG4gICAgaWYgKHdpbmRvdy5hbmd1bGFyKSB7XG4gICAgICAgIChmdW5jdGlvbiAoYW5ndWxhcikge1xuICAgICAgICAgICAgYW5ndWxhci5tb2R1bGUoJ2pRdWVyeVNjcm9sbGJhcicsIFtdKVxuICAgICAgICAgICAgICAgIC5wcm92aWRlcignalF1ZXJ5U2Nyb2xsYmFyJywgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgZGVmYXVsdE9wdGlvbnMgPSBkZWZhdWx0cztcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHNldE9wdGlvbnM6IGZ1bmN0aW9uIChvcHRpb25zKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYW5ndWxhci5leHRlbmQoZGVmYXVsdE9wdGlvbnMsIG9wdGlvbnMpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgICRnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvcHRpb25zOiBhbmd1bGFyLmNvcHkoZGVmYXVsdE9wdGlvbnMpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgIC5kaXJlY3RpdmUoJ2pxdWVyeVNjcm9sbGJhcicsIFsnalF1ZXJ5U2Nyb2xsYmFyJywgJyRwYXJzZScsIGZ1bmN0aW9uIChqUXVlcnlTY3JvbGxiYXIsICRwYXJzZSkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgXCJyZXN0cmljdFwiOiBcIkFDXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICBcImxpbmtcIjogZnVuY3Rpb24gKHNjb3BlLCBlbGVtZW50LCBhdHRycykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBtb2RlbCA9ICRwYXJzZShhdHRycy5qcXVlcnlTY3JvbGxiYXIpLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvcHRpb25zID0gbW9kZWwoc2NvcGUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsZW1lbnQuc2Nyb2xsYmFyKG9wdGlvbnMgfHwgalF1ZXJ5U2Nyb2xsYmFyLm9wdGlvbnMpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5vbignJGRlc3Ryb3knLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbGVtZW50LnNjcm9sbGJhcignZGVzdHJveScpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICB9XSk7XG4gICAgICAgIH0pKHdpbmRvdy5hbmd1bGFyKTtcbiAgICB9XG59KSk7XG4iXX0=
